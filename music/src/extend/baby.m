clear all, close all, clc;

Fs = 8000;
beat_len = 0.5;

ratio = 2^(1/12);

high_tunes = get_more_tunes('C', 'high');
low_tunes = get_more_tunes('C', 'low');

low = @(x) x;
mid = @(x) x + 7;
hig = @(x) x + 14;
vhi = @(x) x + 21;
pse = @(x) 29;


song1 = [...
    mid(1), 1; mid(2), 1; mid(3), 1; mid(1), 1; ...    % Liang zhi lao hu
    mid(2), 1; mid(5), 1; mid(5), 1; pse(0), 1; ...
    mid(3), 1; mid(6), 0.5; mid(6), 0.5; mid(6), 1; mid(6), 1; ...    % Xiao tu zi guai guai
    mid(5), 0.5; mid(3), 0.5; mid(5), 1; mid(3), 1; pse(0), 1; ...
    mid(1), 1.5; mid(1), 0.5; mid(1), 1; mid(6), 0.5; mid(6), 0.5; ... % Wo he xiao ya zi
    mid(5), 1; mid(3), 1; mid(5), 1; pse(0), 1; ...
    mid(2), 0.5; mid(2), 1; mid(3), 0.5; mid(3), 0.5; mid(2), 0.5; mid(1), 0.5; mid(3), 0.5; ... % Tong nian shi zui mei
    mid(2), 2; low(5), 0.5; low(6), 0.5; low(7), 0.5; mid(2), 0.5; ...
    mid(1), 1; mid(2), 1; mid(3), 1; mid(1), 1; ... % Xiao luo hao ya
    mid(2), 1; mid(5), 0.5; mid(5), 0.5; mid(5), 1; pse(0), 1; ...
    mid(3), 1; mid(6), 1; mid(6), 1; hig(1), 1; ... % Wo qu hai ou
    mid(7), 1; mid(6), 1; mid(5), 1; pse(0), 1; ...
    mid(1), 1.5; mid(1), 0.5; mid(1), 1; mid(6), 1; ... % Bu pa feng yu
    mid(5), 1; mid(5), 1; mid(3), 1; pse(0), 1; ...
    mid(2), 0.5; mid(2), 1; mid(3), 0.5; mid(3), 0.5; mid(2), 0.5; mid(1), 0.5; mid(2), 0.5; ... % Kuai kuai ba ben ling
    mid(1), 2; mid(1), 0.5; mid(2), 0.5; mid(3), 0.5; mid(5), 0.5; ...
    hig(1), 1.5; hig(1), 0.5; hig(1), 0.5; mid(5), 0.5; mid(3), 0.5; hig(1), 0.5; ... % Bao bei xing xing
    mid(7), 2; pse(0), 1; pse(0), 0.5; mid(3), 0.5; ...
    mid(6), 1.5; mid(6), 0.5; mid(6), 0.5; mid(5), 0.5; mid(6), 0.5; mid(7), 0.5; ... % Bao bei yue liang
    mid(5), 2; pse(0), 1; pse(0), 1; ...
    mid(3), 1; mid(5), 0.5; mid(5), 0.5; mid(5), 1; hig(1), 1; ... % Cheng zhang shi kuai le
    hig(2), 1.5; hig(2), 0.5; mid(6), 2; ...
    mid(5), 0.5; mid(5), 0.5; mid(5), 0.5; mid(6), 0.5; mid(7), 0.5; mid(6), 0.5; mid(7), 0.5; hig(1), 0.5; ... % Yong gan mai kai
    hig(2), 3; pse(0), 0.5; mid(5), 0.5; ...
    hig(1), 1.5; hig(1), 0.5; hig(1), 0.5; mid(5), 0.5; mid(3), 0.5; hig(1), 0.5; ... % Bao bei ma ma huai li
    mid(7), 2; pse(0), 1; pse(0), 0.5; mid(3), 0.5; ...
    mid(6), 1.5; mid(6), 0.5; mid(6), 0.5; mid(5), 0.5; mid(6), 0.5; mid(7), 0.5; ... % Bao bei ba ba shi ni
    mid(5), 2; pse(0), 1; pse(0), 1; ...
    mid(3), 1; mid(5), 1; mid(5), 1; hig(1), 0.5; hig(1), 0.5; ... % Ni shi wo men de
    hig(2), 0.5; hig(2), 0.5; hig(2), 1; mid(6), 2; ...
    mid(5), 0.5; mid(5), 0.5; mid(5), 0.5; mid(6), 0.5; mid(7), 0.5; hig(1), 0.5; hig(1), 0.5; hig(2), 0.5; ... % Ba ba ma ma de ai
    hig(1), 4; ...
    pse(0), 4];

%{
song1_h = [...
    hig(1), 1; hig(2), 1; hig(3), 1; hig(1), 1; ...    % Liang zhi lao hu
    hig(2), 1; hig(5), 1; hig(5), 1; pse(0), 1; ...
    hig(3), 1; hig(6), 0.5; hig(6), 0.5; hig(6), 1; hig(6), 1; ...    % Xiao tu zi guai guai
    hig(5), 0.5; hig(3), 0.5; hig(5), 1; hig(3), 1; pse(0), 1; ...
    hig(1), 1.5; hig(1), 0.5; hig(1), 1; hig(6), 0.5; hig(6), 0.5; ... % Wo he xiao ya zi
    hig(5), 1; hig(3), 1; hig(5), 1; pse(0), 1; ...
    hig(2), 0.5; hig(2), 1; hig(3), 0.5; hig(3), 0.5; hig(2), 0.5; hig(1), 0.5; hig(3), 0.5; ... % Tong nian shi zui mei
    hig(2), 2; mid(5), 0.5; mid(6), 0.5; mid(7), 0.5; hig(2), 0.5; ...
    hig(1), 1; hig(2), 1; hig(3), 1; hig(1), 1; ... % Xiao luo hao ya
    hig(2), 1; hig(5), 0.5; hig(5), 0.5; hig(5), 1; pse(0), 1; ...
    hig(3), 1; hig(6), 1; hig(6), 1; vhi(1), 1; ... % Wo qu hai ou
    hig(7), 1; hig(6), 1; hig(5), 1; pse(0), 1; ...
    hig(1), 1.5; hig(1), 0.5; hig(1), 1; hig(6), 1; ... % Bu pa feng yu
    hig(5), 1; hig(5), 1; hig(3), 1; pse(0), 1; ...
    hig(2), 0.5; hig(2), 1; hig(3), 0.5; hig(3), 0.5; hig(2), 0.5; hig(1), 0.5; hig(2), 0.5; ... % Kuai kuai ba ben ling
    hig(1), 2; hig(1), 0.5; hig(2), 0.5; hig(3), 0.5; hig(5), 0.5; ...
    vhi(1), 1.5; vhi(1), 0.5; vhi(1), 0.5; hig(5), 0.5; hig(3), 0.5; vhi(1), 0.5; ... % Bao bei xing xing
    hig(7), 2; pse(0), 1; pse(0), 0.5; hig(3), 0.5; ...
    hig(6), 1.5; hig(6), 0.5; hig(6), 0.5; hig(5), 0.5; hig(6), 0.5; hig(7), 0.5; ... % Bao bei yue liang
    hig(5), 2; pse(0), 1; pse(0), 1; ...
    hig(3), 1; hig(5), 0.5; hig(5), 0.5; hig(5), 1; vhi(1), 1; ... % Cheng zhang shi kuai le
    vhi(2), 1.5; vhi(2), 0.5; hig(6), 2; ...
    hig(5), 0.5; hig(5), 0.5; hig(5), 0.5; hig(6), 0.5; hig(7), 0.5; hig(6), 0.5; hig(7), 0.5; vhi(1), 0.5; ... % Yong gan mai kai
    vhi(2), 3; pse(0), 0.5; hig(5), 0.5; ...
    vhi(1), 1.5; vhi(1), 0.5; vhi(1), 0.5; hig(5), 0.5; hig(3), 0.5; vhi(1), 0.5; ... % Bao bei ma ma huai li
    hig(7), 2; pse(0), 1; pse(0), 0.5; hig(3), 0.5; ...
    hig(6), 1.5; hig(6), 0.5; hig(6), 0.5; hig(5), 0.5; hig(6), 0.5; hig(7), 0.5; ... % Bao bei ba ba shi ni
    hig(5), 2; pse(0), 1; pse(0), 1; ...
    hig(3), 1; hig(5), 1; hig(5), 1; vhi(1), 0.5; vhi(1), 0.5; ... % Ni shi wo men de
    vhi(2), 0.5; vhi(2), 0.5; vhi(2), 1; hig(6), 2; ...
    hig(5), 0.5; hig(5), 0.5; hig(5), 0.5; hig(6), 0.5; hig(7), 0.5; vhi(1), 0.5; vhi(1), 0.5; vhi(2), 0.5; ... % Ba ba ma ma de ai
    vhi(1), 4; ...
    pse(0), 4];
%}

song2 = [...
    mid(1), 1; mid(5), 1; hig(1), 1; mid(5), 1; low(7), 1; mid(5), 1; mid(7), 1; mid(5), 1; ...
    low(6), 1; mid(3), 1; mid(6), 1; mid(3), 1; low(5), 1; mid(3), 1; mid(5), 1; mid(3), 1; ...
    low(4), 1; mid(1), 1; mid(4), 1; mid(1), 1; low(3), 1; mid(1), 1; mid(3), 1; mid(1), 1; ...
    low(2), 1; low(6), 1; mid(2), 1; low(6), 1; low(5), 1; mid(2), 1; mid(5), 1; mid(2), 1; ...
    mid(1), 1; mid(5), 1; hig(1), 1; mid(5), 1; low(7), 1; mid(5), 1; mid(7), 1; mid(5), 1; ...
    low(6), 1; mid(3), 1; mid(6), 1; mid(3), 1; low(5), 1; mid(3), 1; mid(5), 1; mid(3), 1; ...
    low(4), 1; mid(1), 1; mid(4), 1; mid(1), 1; low(3), 1; mid(1), 1; mid(3), 1; mid(1), 1; ...
    low(2), 1; low(6), 1; mid(2), 1; low(6), 1; mid(1), 1; mid(5), 1; hig(1), 1; mid(5), 1; ...
    mid(1), 1; hig(3), 1; hig(3), 1; hig(3), 1; low(3), 1; mid(5), 1; mid(5), 1; mid(5), 1; ...
    low(4), 1; mid(6), 1; mid(6), 1; mid(6), 1; low(5), 1; mid(7), 1; mid(7), 1; mid(7), 1; ...
    mid(1), 1; hig(3), 1; hig(3), 1; hig(3), 1; mid(2), 1; hig(4), 1; hig(4), 1; hig(4), 1; ...
    low(5), 1; mid(7), 1; mid(7), 1; mid(7), 1; low(5), 1; mid(7), 1; mid(7), 1; mid(7), 1; ...

    mid(1), 1; hig(3), 1; hig(3), 1; hig(3), 1; low(3), 1; mid(5), 1; mid(5), 1; mid(5), 1; ...
    low(4), 1; mid(6), 1; mid(6), 1; mid(6), 1; low(5), 1; mid(7), 1; mid(7), 1; mid(7), 1; ...
    mid(1), 1; hig(3), 1; hig(3), 1; hig(3), 1; mid(2), 1; hig(4), 1; hig(4), 1; hig(4), 1; ...
    low(5), 1; mid(7), 1; mid(7), 1; mid(7), 1; mid(1), 1; hig(3), 1; hig(3), 1; hig(3), 1; ...
    pse(0), 4];

song2_1 = [...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; pse(0), 1; ...
    pse(0), 1; hig(1), 1; hig(1), 1; hig(1), 1; pse(0), 1; mid(3), 1; mid(3), 1; mid(3), 1; ...
    pse(0), 1; mid(4), 1; mid(4), 1; mid(4), 1; pse(0), 1; mid(5), 1; mid(5), 1; mid(5), 1; ...
    pse(0), 1; hig(1), 1; hig(1), 1; hig(1), 1; pse(0), 1; hig(2), 1; hig(2), 1; hig(2), 1; ...
    pse(0), 1; mid(5), 1; mid(5), 1; mid(5), 1; pse(0), 1; mid(5), 1; mid(5), 1; mid(5), 1; ...

    pse(0), 1; hig(1), 1; hig(1), 1; hig(1), 1; pse(0), 1; mid(3), 1; mid(3), 1; mid(3), 1; ...
    pse(0), 1; mid(4), 1; mid(4), 1; mid(4), 1; pse(0), 1; mid(5), 1; mid(5), 1; mid(5), 1; ...
    pse(0), 1; hig(1), 1; hig(1), 1; hig(1), 1; pse(0), 1; hig(2), 1; hig(2), 1; hig(2), 1; ...
    pse(0), 1; mid(5), 1; mid(5), 1; mid(5), 1; pse(0), 1; hig(1), 1; hig(3), 1; hig(3), 1; ...
    pse(0), 8];

song3 = [...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Liang zhi lao hu
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Xiao tu zi guai guai
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Wo he xiao ya zi
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Tong nian shi zui mei
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Xiao luo hao ya
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Wo qu hai ou
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Bu pa feng yu
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Kuai kuai ba ben ling
    low(1), 1; low(2), 0.5; pse(0), 0.5; low(2), 1; low(3), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Bao bei xing xing
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Bao bei yue liang
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Cheng zhang shi kuai le
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Yong gan mai kai
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Bao bei ma ma huai li
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Bao bei ba ba shi ni % Ni shi wo men de
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ... % Ni shi wo men de % Yong gan mai kai
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; pse(0), 0.5; ...
    low(2), 1; low(3), 0.5; pse(0), 0.5; low(1), 1; low(2), 0.5; low(3), 0.5; ... % Ba ba ma ma de ai
    low(3), 1; low(4), 0.5; pse(0), 0.5; low(1), 1.5; pse(0), 0.5;
    pse(0), 6];

harm = [1; 0.2; 0.1; 0.01; 0.006];

res1 = produce(song1, high_tunes, Fs, beat_len, harm);
res2 = produce(song2, low_tunes, Fs, beat_len, harm);
res2_1 = produce(song2_1, low_tunes, Fs, beat_len, harm);
res3 = produce(song3, high_tunes, Fs, beat_len, harm);

len1 = length(res1);
len2 = length(res2);
len2_1 = length(res2_1);
len3 = length(res3);

if len2_1 > len2
    res2_1 = res2_1(1:len2);
end
res2 = res2 + res2_1;

if len2 > len1
    res2 = res2(1:len1);
end
if len3 > len1
    res3 = res3(1:len1);
end

res = 1 * res1 + 0.65 * res2 + 0.05 * res3;

res = res * 0.5;
sound(res, Fs);
plot(res);
audiowrite('baby.wav', res, Fs);
